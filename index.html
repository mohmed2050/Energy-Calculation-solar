<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام حساب متطلبات الطاقة الشمسية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --accent-color: #f59e0b;
            --light-color: #f0f9ff;
            --dark-color: #1e3a8a;
            --success-color: #10b981;
            --text-color: #1f2937;
            --gradient-start: #2563eb;
            --gradient-end: #7c3aed;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            padding: 1.5rem;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        h1, h2, h3 {
            margin-bottom: 15px;
            color: var(--dark-color);
        }
        
        header h1 {
            color: white;
            font-size: 2.2rem;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        
        button {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        button i {
            margin-left: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        table, th, td {
            border: 1px solid #e5e7eb;
        }
        
        th, td {
            padding: 14px;
            text-align: center;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f9fafb;
        }
        
        .device-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .device-item {
            background: var(--light-color);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid #e0f2fe;
        }
        
        .device-item:hover {
            background: var(--secondary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.2);
        }
        
        .results {
            display: none;
            background: linear-gradient(to bottom, #e0f2fe, #f0f9ff);
            padding: 25px;
            border-radius: 12px;
            margin-top: 25px;
            border: 2px solid #bfdbfe;
        }
        
        .summary-item {
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-right: 5px solid var(--secondary-color);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        
        .stat-box i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-color);
            margin: 10px 0;
        }
        
        .review-section {
            background: linear-gradient(to right, #fef3c7, #fde68a);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-top: 30px;
            border: 2px solid #f59e0b;
        }
        
        .review-section h2 {
            color: #92400e;
        }
        
        .reviewer {
            display: inline-flex;
            align-items: center;
            background: white;
            padding: 12px 25px;
            border-radius: 30px;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .reviewer img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-left: 15px;
            border: 3px solid #f59e0b;
        }
        
        /* الرسوم البيانية */
        .chart-container {
            height: 40px;
            background: #e5e7eb;
            border-radius: 20px;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }
        
        .chart-fill {
            height: 100%;
            border-radius: 20px;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            width: 0;
            transition: width 1.5s ease-in-out;
        }
        
        /* قسم المعلومات الجديد */
        .info-section {
            background: linear-gradient(to right, #dcfce7, #bbf7d0);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid #86efac;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .info-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .info-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        
        .info-content.expanded {
            max-height: 1000px;
        }
        
        .info-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .info-table th {
            background-color: var(--success-color);
        }
        
        .more-info-btn {
            background: var(--accent-color);
            margin-top: 15px;
        }
        
        .more-info-content {
            display: none;
            padding: 15px;
            background: #fffbeb;
            border-radius: 8px;
            margin-top: 15px;
            border-right: 4px solid var(--accent-color);
        }
        
        .more-info-content.show {
            display: block;
        }
        
        /* responsive design */
        @media (max-width: 768px) {
            .device-list {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
            
            .info-table {
                display: block;
                overflow-x: auto;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            button {
                width: 100%;
            }
            
            .device-list {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animated {
            animation: fadeIn 0.8s ease forwards;
        }
        
        .delay-1 { animation-delay: 0.2s; }
        .delay-2 { animation-delay: 0.4s; }
        .delay-3 { animation-delay: 0.6s; }
        
        /* notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success-color);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateX(100%);
            transition: transform 0.4s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="animated">
            <h1><i class="fas fa-solar-panel"></i> نظام حساب متطلبات الطاقة الشمسية</h1>
            <p>احسب متطلباتك من الطاقة الشمسية بسهولة ودقة</p>
        </header>
        
        <!-- قسم المعلومات الجديد -->
        <div class="info-section animated" id="infoSection">
            <div class="info-header">
                <h2><i class="fas fa-info-circle"></i> معلومات عن القيم المستخدمة</h2>
                <i class="fas fa-chevron-down" id="infoIcon"></i>
            </div>
            <div class="info-content" id="infoContent">
                <p>القيم المستخدمة في هذا الموقع هي قيم متوسطة تعتمد على قياسات عملية لمعظم الأجهزة المنزلية الشائعة.</p>
                
                <h3><i class="fas fa-fan"></i> لماذا اخترنا 50 واط للمروحة؟</h3>
                <p>تم اختيار قيمة 50 واط لأنها تمثل متوسط استهلاك معظم المراوح المنزلية عند التشغيل على سرعة متوسطة. هذه القيمة تتضمن هامش أمان لضمان دقة الحسابات.</p>
                
                <h3><i class="fas fa-table"></i> جدول تحويل الوحدات الكهربائية</h3>
                <table class="info-table">
                    <thead>
                        <tr>
                            <th>الوحدة</th>
                            <th>الرمز</th>
                            <th>طريقة التحويل إلى واط</th>
                            <th>مثال</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>فولت وأمبير</td>
                            <td>V & A</td>
                            <td>الوات = الفولت × الأمبير</td>
                            <td>220V × 0.23A = 50W</td>
                        </tr>
                        <tr>
                            <td>قوة الحصان</td>
                            <td>HP</td>
                            <td>الوات = الحصان × 746</td>
                            <td>0.067HP × 746 = 50W</td>
                        </tr>
                        <tr>
                            <td>كيلوواط</td>
                            <td>kW</td>
                            <td>الوات = الكيلوواط × 1000</td>
                            <td>0.05kW × 1000 = 50W</td>
                        </tr>
                    </tbody>
                </table>
                
                <button class="more-info-btn" id="moreInfoBtn"><i class="fas fa-book-open"></i> اقرأ المزيد عن التحويلات</button>
                
                <div class="more-info-content" id="moreInfoContent">
                    <h4><i class="fas fa-bolt"></i> كيفية حساب استهلاك الأجهزة بنفسك:</h4>
                    <p>لحساب استهلاك أي جهاز للطاقة، ابحث عن الملصق الموجود على الجهاز والذي يحتوي على معلومات الكهرباء. ستجد عادةً واحدة من هذه القيم:</p>
                    <ul>
                        <li><strong>الفولتية والتيار (V & A)</strong>: اضرب الرقمين معاً لتحصل على الاستهلاك بالواط</li>
                        <li><strong>الاستهلاك المباشر بالواط (W)</strong>: يمكنك استخدامه مباشرة</li>
                        <li><strong>قوة الحصان (HP)</strong>: اضرب في 746 لتحصل على الواط</li>
                    </ul>
                    
                    <h4><i class="fas fa-tachometer-alt"></i> لماذا نستخدم قيماً متوسطة؟</h4>
                    <p>استخدام قيم متوسطة يسهل عملية الحساب للمستخدم العادي دون الحاجة إلى البحث عن المواصفات الدقيقة لكل جهاز. كما أن هذه القيم تتضمن هامش أمان لضمان أن النظام الشمسي سيعمل بكفاءة حتى لو كان الاستهلاك الفعلي أعلى قليلاً.</p>
                </div>
            </div>
        </div>
        
        <div class="card animated delay-1">
            <h2><i class="fas fa-bolt"></i> الأجهزة المنزلية الشائعة</h2>
            <div class="device-list" id="commonDevices">
                <!-- سيتم ملؤها بواسطة JavaScript -->
            </div>
            
            <h2><i class="fas fa-plus-circle"></i> أضف جهازك الخاص</h2>
            <div class="form-group">
                <label for="deviceName"><i class="fas fa-tag"></i> اسم الجهاز:</label>
                <input type="text" id="deviceName" placeholder="أدخل اسم الجهاز">
            </div>
            <div class="form-group">
                <label for="devicePower"><i class="fas fa-bolt"></i> استهلاك الجهاز (واط):</label>
                <input type="number" id="devicePower" placeholder="أدخل استهلاك الجهاز بالواط">
            </div>
            <div class="form-group">
                <label for="deviceHours"><i class="fas fa-clock"></i> عدد ساعات التشغيل اليومية:</label>
                <input type="number" id="deviceHours" placeholder="عدد الساعات يومياً">
            </div>
            <div class="form-group">
                <label for="deviceQuantity"><i class="fas fa-calculator"></i> الكمية:</label>
                <input type="number" id="deviceQuantity" value="1" min="1">
            </div>
            <button id="addDevice"><i class="fas fa-plus"></i> إضافة الجهاز</button>
        </div>
        
        <div class="card animated delay-2">
            <h2><i class="fas fa-list"></i> الأجهزة المضافة</h2>
            <table id="devicesTable">
                <thead>
                    <tr>
                        <th>اسم الجهاز</th>
                        <th>الاستهلاك (واط)</th>
                        <th>ساعات التشغيل</th>
                        <th>الكمية</th>
                        <th>الاستهلاك اليومي (واط/ساعة)</th>
                        <th>إجراءات</th>
                    </tr>
                </thead>
                <tbody id="devicesList">
                    <!-- سيتم ملؤها بواسطة JavaScript -->
                </tbody>
            </table>
            
            <div class="form-group">
                <label for="sunHours"><i class="fas fa-sun"></i> متوسط ساعات الشمس اليومية في منطقتك:</label>
                <input type="number" id="sunHours" value="5" min="1" max="24">
            </div>
            
            <div class="form-group">
                <label for="batteryVoltage"><i class="fas fa-car-battery"></i> جهد النظام (فولت):</label>
                <select id="batteryVoltage">
                    <option value="12">12 فولت</option>
                    <option value="24">24 فولت</option>
                    <option value="48">48 فولت</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="autonomyDays"><i class="fas fa-calendar-day"></i> عدد أيام الاحتياطي (في حالة عدم وجود شمس):</label>
                <input type="number" id="autonomyDays" value="1" min="1" max="7">
            </div>
            
            <button id="calculateBtn"><i class="fas fa-calculator"></i> حساب المتطلبات</button>
        </div>
        
        <div class="card results animated delay-3" id="resultsSection">
            <h2><i class="fas fa-chart-pie"></i> نتائج الحساب</h2>
            
            <div class="stats-container">
                <div class="stat-box">
                    <i class="fas fa-plug"></i>
                    <h3>الاستهلاك اليومي</h3>
                    <div class="stat-value" id="totalConsumption">0</div>
                    <p>واط/ساعة</p>
                    <div class="chart-container">
                        <div class="chart-fill" id="consumptionChart"></div>
                    </div>
                </div>
                
                <div class="stat-box">
                    <i class="fas fa-car-battery"></i>
                    <h3>سعة البطارية</h3>
                    <div class="stat-value" id="batteryCapacityWithBackup">0</div>
                    <p>أمبير/ساعة</p>
                    <div class="chart-container">
                        <div class="chart-fill" id="batteryChart"></div>
                    </div>
                </div>
                
                <div class="stat-box">
                    <i class="fas fa-solar-panel"></i>
                    <h3>الألواح الشمسية</h3>
                    <div class="stat-value" id="solarPanelCount">0</div>
                    <p>لوح (300 واط)</p>
                    <div class="chart-container">
                        <div class="chart-fill" id="solarChart"></div>
                    </div>
                </div>
            </div>
            
            <div class="summary-item">
                <h3><i class="fas fa-info-circle"></i> تفاصيل المتطلبات</h3>
                <p>سعة البطارية الأساسية: <span id="batteryCapacity">0</span> أمبير/ساعة</p>
                <p>قدرة الألواح المطلوبة: <span id="solarPanelPower">0</span> واط</p>
                <p>سعة المنظم المطلوبة: <span id="chargeControllerCapacity">0</span> أمبير</p>
                <p>قدرة الانفرتر المطلوبة: <span id="inverterCapacity">0</span> واط</p>
            </div>
        </div>
        
        <div class="review-section animated">
            <h2><i class="fas fa-star"></i> تم المراجعة بواسطة</h2>
            <div class="reviewer">
                <img src="https://c.top4top.io/p_3532vd0gy1.jpg" alt="خبير الطاقة">
                <div>
                    <h3>المهندس مرتضى عمر</h3>
                    <p>خبير أنظمة الطاقة الشمسية</p>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> <span id="notificationText"></span>
    </div>

    <script>
        // بيانات الأجهزة الشائعة
        const commonDevices = [
            { name: "مروحة", power: 50, hours: 6, icon: "fan" },
            { name: "تلفاز LED", power: 80, hours: 5, icon: "tv" },
            { name: "ثلاجة صغيرة", power: 100, hours: 8, icon: "refrigerator" },
            { name: "إنارة LED", power: 10, hours: 8, icon: "lightbulb" },
            { name: "حاسوب محمول", power: 60, hours: 4, icon: "laptop" },
            { name: "راوتر", power: 10, hours: 24, icon: "wifi" },
            { name: "شاحن هاتف", power: 5, hours: 3, icon: "mobile-alt" },
            { name: "ميكروويف", power: 1000, hours: 0.5, icon: "microwave" },
            { name: "غسالة ملابس", power: 500, hours: 1, icon: "tshirt" },
            { name: "مكيف صغير", power: 1000, hours: 4, icon: "snowflake" }
        ];

        // مصفوفة لتخزين الأجهزة المضافة
        let devices = [];
        let maxConsumption = 5000; // لأغراض الرسم البياني

        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            // عرض الأجهزة الشائعة
            renderCommonDevices();
            
            // إضافة مستمعي الأحداث
            document.getElementById('addDevice').addEventListener('click', addCustomDevice);
            document.getElementById('calculateBtn').addEventListener('click', calculateRequirements);
            document.getElementById('infoSection').addEventListener('click', toggleInfoSection);
            document.getElementById('moreInfoBtn').addEventListener('click', toggleMoreInfo);
            
            // إظهار الرسوم المتحركة للعناصر
            document.querySelectorAll('.animated').forEach(el => {
                el.style.opacity = '0';
            });
            
            setTimeout(() => {
                document.querySelectorAll('.animated').forEach(el => {
                    el.style.opacity = '1';
                });
            }, 100);
        });

        // تبديل قسم المعلومات
        function toggleInfoSection() {
            const infoContent = document.getElementById('infoContent');
            const infoIcon = document.getElementById('infoIcon');
            
            infoContent.classList.toggle('expanded');
            
            if (infoContent.classList.contains('expanded')) {
                infoIcon.className = 'fas fa-chevron-up';
            } else {
                infoIcon.className = 'fas fa-chevron-down';
                // إخفاء المحتوى الإضافي إذا كان مفتوحاً
                document.getElementById('moreInfoContent').classList.remove('show');
            }
        }
        
        // تبديل المحتوى الإضافي
        function toggleMoreInfo(event) {
            event.stopPropagation(); // منع تنفيذ الحدث على العنصر الأب
            const moreInfoContent = document.getElementById('moreInfoContent');
            moreInfoContent.classList.toggle('show');
        }

        // عرض الإشعار
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // عرض الأجهزة الشائعة
        function renderCommonDevices() {
            const container = document.getElementById('commonDevices');
            container.innerHTML = '';
            
            commonDevices.forEach(device => {
                const div = document.createElement('div');
                div.className = 'device-item';
                div.innerHTML = `
                    <h4><i class="fas fa-${device.icon}"></i> ${device.name}</h4>
                    <p>${device.power} واط - ${device.hours} ساعات</p>
                `;
                div.addEventListener('click', () => {
                    addDevice(device);
                    showNotification(`تمت إضافة ${device.name} إلى القائمة`);
                });
                container.appendChild(div);
            });
        }

        // إضافة جهاز من القائمة
        function addDevice(device) {
            devices.push({
                name: device.name,
                power: device.power,
                hours: device.hours,
                quantity: 1
            });
            renderDevicesTable();
        }

        // إضافة جهاز مخصص
        function addCustomDevice() {
            const name = document.getElementById('deviceName').value;
            const power = parseInt(document.getElementById('devicePower').value);
            const hours = parseInt(document.getElementById('deviceHours').value);
            const quantity = parseInt(document.getElementById('deviceQuantity').value);
            
            if (!name || !power || !hours) {
                showNotification('يرجى ملء جميع الحقول');
                return;
            }
            
            devices.push({
                name: name,
                power: power,
                hours: hours,
                quantity: quantity
            });
            
            // مسح الحقول
            document.getElementById('deviceName').value = '';
            document.getElementById('devicePower').value = '';
            document.getElementById('deviceHours').value = '';
            document.getElementById('deviceQuantity').value = 1;
            
            renderDevicesTable();
            showNotification(`تمت إضافة ${name} إلى القائمة`);
        }

        // عرض الأجهزة في الجدول
        function renderDevicesTable() {
            const tbody = document.getElementById('devicesList');
            tbody.innerHTML = '';
            
            devices.forEach((device, index) => {
                const dailyConsumption = device.power * device.hours * device.quantity;
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${device.name}</td>
                    <td>${device.power}</td>
                    <td>${device.hours}</td>
                    <td>${device.quantity}</td>
                    <td>${dailyConsumption}</td>
                    <td><button onclick="removeDevice(${index})"><i class="fas fa-trash"></i> حذف</button></td>
                `;
                tbody.appendChild(tr);
            });
        }

        // إزالة جهاز
        function removeDevice(index) {
            const deviceName = devices[index].name;
            devices.splice(index, 1);
            renderDevicesTable();
            showNotification(`تم حذف ${deviceName} من القائمة`);
        }

        // حساب متطلبات النظام
        function calculateRequirements() {
            if (devices.length === 0) {
                showNotification('يرجى إضافة جهاز واحد على الأقل');
                return;
            }
            
            // حساب إجمالي الاستهلاك اليومي
            const totalConsumption = devices.reduce((total, device) => {
                return total + (device.power * device.hours * device.quantity);
            }, 0);
            
            // تحديث الحد الأقصى للرسم البياني إذا لزم الأمر
            if (totalConsumption > maxConsumption) {
                maxConsumption = totalConsumption * 1.2;
            }
            
            // الحصول على مدخلات المستخدم
            const sunHours = parseInt(document.getElementById('sunHours').value);
            const batteryVoltage = parseInt(document.getElementById('batteryVoltage').value);
            const autonomyDays = parseInt(document.getElementById('autonomyDays').value);
            
            // حساب سعة البطارية (أمبير/ساعة)
            const batteryCapacity = Math.ceil(totalConsumption / batteryVoltage);
            const batteryCapacityWithBackup = Math.ceil(batteryCapacity * autonomyDays * 1.2); // زيادة 20% للكفاءة
            
            // حساب قدرة الألواح الشمسية
            const solarPanelPower = Math.ceil(totalConsumption / sunHours * 1.3); // زيادة 30% للكفاءة والخسائر
            const solarPanelCount = Math.ceil(solarPanelPower / 300); // افتراض أن اللوح 300 واط
            
            // حساب سعة المنظم
            const chargeControllerCapacity = Math.ceil(solarPanelPower / batteryVoltage * 1.2); // زيادة 20% للسلامة
            
            // حساب قدرة الانفرتر (أعلى استهلاك للجهاز)
            const maxDevicePower = Math.max(...devices.map(device => device.power * device.quantity));
            const inverterCapacity = Math.ceil(maxDevicePower * 1.5); // زيادة 50% للسلامة
            
            // عرض النتائج
            document.getElementById('totalConsumption').textContent = totalConsumption;
            document.getElementById('batteryCapacity').textContent = batteryCapacity;
            document.getElementById('batteryCapacityWithBackup').textContent = batteryCapacityWithBackup;
            document.getElementById('solarPanelPower').textContent = solarPanelPower;
            document.getElementById('solarPanelCount').textContent = solarPanelCount;
            document.getElementById('chargeControllerCapacity').textContent = chargeControllerCapacity;
            document.getElementById('inverterCapacity').textContent = inverterCapacity;
            
            // تحديث الرسوم البيانية
            updateCharts(totalConsumption, batteryCapacityWithBackup, solarPanelCount);
            
            // إظهار قسم النتائج
            document.getElementById('resultsSection').style.display = 'block';
            
            // التمرير إلى القسم النتائج
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            
            showNotification('تم حساب متطلبات النظام الشمسي بنجاح');
        }
        
        // تحديث الرسوم البيانية
        function updateCharts(consumption, battery, solar) {
            // حساب النسب المئوية
            const consumptionPercent = Math.min(100, (consumption / maxConsumption) * 100);
            const batteryPercent = Math.min(100, (battery / 500) * 100); // نفترض أن 500 أمبير/ساعة هو الحد الأقصى للرسم البياني
            const solarPercent = Math.min(100, (solar / 10) * 100); // نفترض أن 10 ألواح هو الحد الأقصى للرسم البياني
            
            // تطبيق العرض على الرسوم البيانية
            document.getElementById('consumptionChart').style.width = consumptionPercent + '%';
            document.getElementById('batteryChart').style.width = batteryPercent + '%';
            document.getElementById('solarChart').style.width = solarPercent + '%';
        }
    </script>
</body>
</html>